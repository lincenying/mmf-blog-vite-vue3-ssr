import{v as e,u as C,l as b,s as k,a as N,b as T,U as V,f as _,e as f}from"./main-BBnOZaJ_.js";import{u as g}from"./use-backend-admin-store-CeHZiBLF.js";import{u as A}from"./vue.8fc199ce-DvXPQa2A.js";const w={class:"card settings-main"},x={class:"settings-main-content"},$={class:"list-email"},D={class:"list-date"},P={class:"list-action"},L=["onClick"],M=["onClick"],R={key:0,class:"settings-footer"},j={key:1,class:"admin-load-more",href:"javascript:;"},H=e.defineComponent({name:"BackendAdminList",asyncData(r){const{store:l,route:c,api:a}=r;return g(l).getAdminList({page:1,path:c.fullPath},a)},__name:"backend-admin-list",setup(r){const l=C(),c=b(),a=g(),d=k(a),i=e.toRef(d,"lists"),h=k(c),y=e.toRef(h,"historyPageScrollTop");N();const[m,u]=T(!1);async function p(t=i.value.page){m.value||(u(!0),await a.getAdminList({page:t,path:l.fullPath}),u(!1))}async function B(t){const{code:s,message:n}=await _.get("backend/admin/recover",{id:t});s===200&&(f({type:"success",content:n}),a.recoverAdmin(t))}async function S(t){const{code:s,message:n}=await _.get("backend/admin/delete",{id:t});s===200&&(f({type:"success",content:n}),a.deleteAdmin(t))}e.onMounted(()=>{if(i.value.path==="")p(1);else{const t=y.value[l.path]||0;window.scrollTo(0,t)}});const v=e.ref("管理员列表 - M.M.F 小屋");return A({title:v,meta:[{name:"description",content:v}]}),(t,s)=>{const n=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",w,[e.createElementVNode("div",x,[s[2]||(s[2]=e.createStaticVNode('<div class="list-section list-header"><div class="list-username">用户名</div><div class="list-email">邮箱</div><div class="list-date">时间</div><div class="list-action">操作</div></div>',1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value.data,o=>(e.openBlock(),e.createElementBlock("div",{key:o._id,class:"list-section"},[e.createElementVNode("div",{class:e.normalizeClass(["list-username",o.is_delete?"text-red-500 line-through":""])},e.toDisplayString(o.username),3),e.createElementVNode("div",$,e.toDisplayString(o.email),1),e.createElementVNode("div",D,e.toDisplayString(e.unref(V)(o.update_date)),1),e.createElementVNode("div",P,[e.createVNode(n,{to:`/backend/admin/modify/${o._id}`,class:"badge badge-success"},{default:e.withCtx(()=>s[1]||(s[1]=[e.createTextVNode("编辑")])),_:2},1032,["to"]),o.is_delete?(e.openBlock(),e.createElementBlock("a",{key:0,href:"javascript:;",onClick:E=>B(o._id)},"恢复",8,L)):(e.openBlock(),e.createElementBlock("a",{key:1,href:"javascript:;",onClick:E=>S(o._id)},"删除",8,M))])]))),128))]),i.value.hasNext?(e.openBlock(),e.createElementBlock("div",R,[e.unref(m)?(e.openBlock(),e.createElementBlock("a",j,"加载中...")):(e.openBlock(),e.createElementBlock("a",{key:0,class:"admin-load-more",href:"javascript:;",onClick:s[0]||(s[0]=o=>p())},"加载更多"))])):e.createCommentVNode("",!0)])}}});export{H as default};
