import{v as e,u as C,l as b,s as k,a as N,b as A,U as T,f as v,e as f}from"./main-BCpYjCEU.js";import{u as h}from"./use-backend-admin-store-Da4Hdzk_.js";import{u as V}from"./vue.f36acd1f-ChkmMf0A.js";const w={class:"card settings-main"},x={class:"settings-main-content"},D=e.createStaticVNode('<div class="list-section list-header"><div class="list-username">用户名</div><div class="list-email">邮箱</div><div class="list-date">时间</div><div class="list-action">操作</div></div>',1),$={class:"list-email"},L={class:"list-date"},M={class:"list-action"},P=["onClick"],R=["onClick"],j={key:0,class:"settings-footer"},F={key:1,class:"admin-load-more",href:"javascript:;"},q=e.defineComponent({name:"BackendAdminList",asyncData(d){const{store:c,route:i,api:o}=d;return h(c).getAdminList({page:1,path:i.fullPath},o)},__name:"backend-admin-list",setup(d){const c=C(),i=b(),o=h(),r=k(o),l=e.toRef(r,"lists"),g=k(i),y=e.toRef(g,"historyPageScrollTop");N();const[m,u]=A(!1);async function p(t=l.value.page){m.value||(u(!0),await o.getAdminList({page:t,path:c.fullPath}),u(!1))}async function B(t){const{code:a,message:n}=await v.get("backend/admin/recover",{id:t});a===200&&(f({type:"success",content:n}),o.recoverAdmin(t))}async function S(t){const{code:a,message:n}=await v.get("backend/admin/delete",{id:t});a===200&&(f({type:"success",content:n}),o.deleteAdmin(t))}e.onMounted(()=>{if(l.value.path==="")p(1);else{const t=y.value[c.path]||0;window.scrollTo(0,t)}});const _=e.ref("管理员列表 - M.M.F 小屋");return V({title:_,meta:[{name:"description",content:_}]}),(t,a)=>{const n=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",w,[e.createElementVNode("div",x,[D,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value.data,s=>(e.openBlock(),e.createElementBlock("div",{key:s._id,class:"list-section"},[e.createElementVNode("div",{class:e.normalizeClass(["list-username",s.is_delete?"text-red-500 line-through":""])},e.toDisplayString(s.username),3),e.createElementVNode("div",$,e.toDisplayString(s.email),1),e.createElementVNode("div",L,e.toDisplayString(e.unref(T)(s.update_date)),1),e.createElementVNode("div",M,[e.createVNode(n,{to:`/backend/admin/modify/${s._id}`,class:"badge badge-success"},{default:e.withCtx(()=>[e.createTextVNode("编辑")]),_:2},1032,["to"]),s.is_delete?(e.openBlock(),e.createElementBlock("a",{key:0,href:"javascript:;",onClick:E=>B(s._id)},"恢复",8,P)):(e.openBlock(),e.createElementBlock("a",{key:1,href:"javascript:;",onClick:E=>S(s._id)},"删除",8,R))])]))),128))]),l.value.hasNext?(e.openBlock(),e.createElementBlock("div",j,[e.unref(m)?(e.openBlock(),e.createElementBlock("a",F,"加载中...")):(e.openBlock(),e.createElementBlock("a",{key:0,class:"admin-load-more",href:"javascript:;",onClick:a[0]||(a[0]=s=>p())},"加载更多"))])):e.createCommentVNode("",!0)])}}});export{q as default};
