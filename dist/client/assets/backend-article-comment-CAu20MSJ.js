import{c as d,d as j,s as k}from"./main-C-aJ0Mow.js";import{d as M,y as D,F as N,q as S,g as $,r as x,a2 as A,c as o,o as n,b as e,a as B,J as L,K as R,a5 as T,M as V,a8 as F,a9 as P,u as _,x as q,a6 as u,ab as E}from"./vendor-BNfFymli.js";import{u as C}from"./use-global-comment-store-BcGjWwTS.js";/* empty css               */const H={class:"card"},J={class:"comments"},K={class:"comment-back"},z={class:"comment-items-wrap"},G={href:"javascript:;",class:"comment-author-avatar-link"},I=["src"],O={class:"comment-content-wrap"},Q={class:"comment-author-wrap"},U={href:"javascript:;",class:"comment-author"},W={class:"comment-content"},X={class:"comment-footer"},Y={class:"comment-time"},Z=["onClick"],ee=["onClick"],te={key:0,class:"load-more-wrap"},se={key:1,href:"javascript:;",class:"comments-load-more"},re=M({name:"BackendArticleComment",asyncData(p){const{store:m,route:c,api:l}=p;return C(m).getCommentList({page:1,path:c.fullPath,all:1,id:c.params.id},l)},__name:"backend-article-comment",setup(p){const m=q(),c=C(),l=D(c),r=N(l,"lists"),[f,h]=S(!1);async function v(t=r.value.page){f.value||(h(!0),await c.getCommentList({page:t,path:m.fullPath,all:1,id:m.params.id},d),h(!1))}async function y(t){const{code:a,message:i}=await d.get("frontend/comment/recover",{id:t});a===200&&(k({type:"success",content:i}),c.recoverComment(t))}async function b(t){const{code:a,message:i}=await d.get("frontend/comment/delete",{id:t});a===200&&(k({type:"success",content:i}),c.deleteComment(t))}$(()=>{r.value.path===""&&v(1)});const g=x("评论列表 - M.M.F 小屋");return A({title:g,meta:[{name:"description",content:g}]}),(t,a)=>{const i=V("router-link");return n(),o("div",H,[e("div",J,[e("div",K,[L(i,{to:"/backend/article/list",class:"btn btn-blue"},{default:R(()=>a[1]||(a[1]=[T("返回")])),_:1,__:[1]})]),e("div",z,[(n(!0),o(F,null,P(r.value.data,s=>(n(),o("div",{key:s._id,class:"comment-item"},[e("a",G,[e("img",{src:("useAvatar"in t?t.useAvatar:_(j))(s.email),alt:"",class:"avatar-img"},null,8,I)]),e("div",O,[e("span",Q,[e("a",U,u(s.username),1)]),e("div",W,u(s.content),1),e("div",X,[e("span",Y,u(_(E)(`${s.timestamp}`)),1),s.is_delete?(n(),o("a",{key:0,href:"javascript:;",class:"comment-action-item comment-reply",onClick:w=>y(s._id)},"恢复",8,Z)):(n(),o("a",{key:1,href:"javascript:;",class:"comment-action-item comment-reply",onClick:w=>b(s._id)},"删除",8,ee))])])]))),128))]),r.value.hasNext?(n(),o("div",te,[_(f)?(n(),o("a",se,"加载中...")):(n(),o("a",{key:0,href:"javascript:;",class:"comments-load-more",onClick:a[0]||(a[0]=s=>v())},"加载更多"))])):B("",!0)])])}}});export{re as default};
