import{d as j,u as D,s as M,t as N,l as S,I as $,r as x,h as A,o,c as n,b as e,e as B,w as L,i as R,F as T,q as V,p as d,x as F,D as u,E as P,j as _,Q as E,C as k}from"./main-CTY4IKlK.js";import{u as C}from"./use-global-comment-store-C6vMCYgp.js";import{u as q}from"./vue.8fc199ce-Bmv443Wm.js";const H={class:"card"},I={class:"comments"},Q={class:"comment-back"},z={class:"comment-items-wrap"},G={href:"javascript:;",class:"comment-author-avatar-link"},J=["src"],K={class:"comment-content-wrap"},O={class:"comment-author-wrap"},U={href:"javascript:;",class:"comment-author"},W={class:"comment-content"},X={class:"comment-footer"},Y={class:"comment-time"},Z=["onClick"],ee=["onClick"],te={key:0,class:"load-more-wrap"},se={key:1,href:"javascript:;",class:"comments-load-more"},ce=j({name:"BackendArticleComment",asyncData(p){const{store:l,route:c,api:m}=p;return C(l).getCommentList({page:1,path:c.fullPath,all:1,id:c.params.id},m)},__name:"backend-article-comment",setup(p){const l=D(),c=C(),m=M(c),r=N(m,"lists"),[h,f]=S(!1);async function v(t=r.value.page){h.value||(f(!0),await c.getCommentList({page:t,path:l.fullPath,all:1,id:l.params.id},u),f(!1))}async function y(t){const{code:a,message:i}=await u.get("frontend/comment/recover",{id:t});a===200&&(k({type:"success",content:i}),c.recoverComment(t))}async function b(t){const{code:a,message:i}=await u.get("frontend/comment/delete",{id:t});a===200&&(k({type:"success",content:i}),c.deleteComment(t))}$(()=>{r.value.path===""&&v(1)});const g=x("评论列表 - M.M.F 小屋");return q({title:g,meta:[{name:"description",content:g}]}),(t,a)=>{const i=A("router-link");return o(),n("div",H,[e("div",I,[e("div",Q,[B(i,{to:"/backend/article/list",class:"btn btn-blue"},{default:L(()=>a[1]||(a[1]=[R("返回")])),_:1})]),e("div",z,[(o(!0),n(T,null,V(r.value.data,s=>(o(),n("div",{key:s._id,class:"comment-item"},[e("a",G,[e("img",{src:("useAvatar"in t?t.useAvatar:d(P))(s.email),alt:"",class:"avatar-img"},null,8,J)]),e("div",K,[e("span",O,[e("a",U,_(s.username),1)]),e("div",W,_(s.content),1),e("div",X,[e("span",Y,_(d(E)(`${s.timestamp}`)),1),s.is_delete?(o(),n("a",{key:0,href:"javascript:;",class:"comment-action-item comment-reply",onClick:w=>y(s._id)},"恢复",8,Z)):(o(),n("a",{key:1,href:"javascript:;",class:"comment-action-item comment-reply",onClick:w=>b(s._id)},"删除",8,ee))])])]))),128))]),r.value.hasNext?(o(),n("div",te,[d(h)?(o(),n("a",se,"加载中...")):(o(),n("a",{key:0,href:"javascript:;",class:"comments-load-more",onClick:a[0]||(a[0]=s=>v())},"加载更多"))])):F("",!0)])])}}});export{ce as default};
