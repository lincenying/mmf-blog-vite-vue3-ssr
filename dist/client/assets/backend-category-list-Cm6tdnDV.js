import{v as e,u as S,l as N,s as p,a as V,b,f as r,e as _}from"./main-BBnOZaJ_.js";import{u as y}from"./use-global-category-store-BpjaM1BR.js";import{u as T}from"./vue.8fc199ce-DvXPQa2A.js";const w={class:"card settings-main"},x={class:"settings-main-content"},P={class:"list-time"},$={class:"list-action"},L=["onClick"],M=["onClick"],j=e.defineComponent({name:"BackendCategoryList",asyncData(i){const{store:l,route:c,api:a}=i;return y(l).getCategoryList({limit:99,path:c.fullPath},a)},__name:"backend-category-list",setup(i){const l=S(),c=N(),a=y(),d=p(a),u=e.toRef(d,"lists"),k=p(c),f=e.toRef(k,"historyPageScrollTop");V();const[v,g]=b(!1);async function h(t){v.value||(g(!0),await a.getCategoryList({page:t,limit:99,path:l.fullPath},r),g(!1))}e.onMounted(()=>{if(u.value.length===0)h(1);else{const t=f.value[l.path]||0;window.scrollTo(0,t)}});async function C(t){const{code:s,message:n}=await r.get("backend/category/recover",{id:t});s===200&&(_({type:"success",content:n}),a.recoverCategory(t))}async function E(t){const{code:s,message:n}=await r.get("backend/category/delete",{id:t});s===200&&(_({type:"success",content:n}),a.deleteCategory(t))}const m=e.ref("分类列表 - M.M.F 小屋");return T({title:m,meta:[{name:"description",content:m}]}),(t,s)=>{const n=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",w,[e.createElementVNode("div",x,[s[1]||(s[1]=e.createElementVNode("div",{class:"list-section list-header"},[e.createElementVNode("div",{class:"list-title"},"分类名称"),e.createElementVNode("div",{class:"list-date"},"分类排序"),e.createElementVNode("div",{class:"list-action"},"操作")],-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.value,o=>(e.openBlock(),e.createElementBlock("div",{key:o._id,class:"list-section"},[e.createElementVNode("div",{class:e.normalizeClass(["list-title",o.is_delete?"text-red-500 line-through":""])},e.toDisplayString(o.cate_name),3),e.createElementVNode("div",P,e.toDisplayString(o.cate_order),1),e.createElementVNode("div",$,[e.createVNode(n,{to:`/backend/category/modify/${o._id}`,class:"badge badge-success"},{default:e.withCtx(()=>s[0]||(s[0]=[e.createTextVNode("编辑")])),_:2},1032,["to"]),o.cate_num?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[o.is_delete?(e.openBlock(),e.createElementBlock("a",{key:0,href:"javascript:;",onClick:B=>C(o._id)},"恢复",8,L)):(e.openBlock(),e.createElementBlock("a",{key:1,href:"javascript:;",onClick:B=>E(o._id)},"删除",8,M))],64))])]))),128))])])}}});export{j as default};
