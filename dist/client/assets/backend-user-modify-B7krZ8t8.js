import{_}from"./a-input.vue_vue_type_script_setup_true_lang-CsH4OfB8.js";import{v as e,u as N,j as k,s as x,b as g,e as f,f as y}from"./main-BBnOZaJ_.js";import{u as v}from"./use-backend-user-store-DS8iL7BQ.js";import{u as E}from"./vue.8fc199ce-DvXPQa2A.js";const M={class:"settings-main card"},U={class:"settings-main-content"},h={class:"settings-footer"},S=e.defineComponent({name:"BackendUserModify",asyncData(u){const{store:d,route:i,api:l}=u;return v(d).getUserItem({id:i.params.id,path:i.fullPath,from:"backend"},l)},__name:"backend-user-modify",setup(u){const d=N(),i=k(),l=v(),m=x(l),n=e.toRef(m,"item"),[V,c]=g(!1),a=e.reactive({id:d.params.id,username:"",email:"",password:""});e.watch(n.value,s=>{s.data&&(a.username=s.data.username,a.email=s.data.email)}),e.onMounted(async()=>{n.value&&n.value.data&&(a.username=n.value.data.username,a.email=n.value.data.email)});async function b(){if(!a.username||!a.email){f("请将表单填写完整!");return}if(V.value)return;c(!0);const{code:s,data:t,message:o}=await y.post("backend/user/modify",a);c(!1),s===200&&(f({type:"success",content:o}),l.updateUserItem(t),i.push("/backend/user/list"))}const p=e.ref("用户编辑 - M.M.F 小屋");return E({title:p,meta:[{name:"description",content:p}]}),(s,t)=>{const o=_,w=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",M,[e.createElementVNode("div",U,[e.createElementVNode("form",null,[e.createVNode(o,{title:"昵称"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>e.unref(a).username=r),type:"text",placeholder:"昵称",class:"base-input",name:"username"},null,512),[[e.vModelText,e.unref(a).username]]),t[3]||(t[3]=e.createElementVNode("span",{class:"input-info error"},"请输入昵称",-1))]),_:1}),e.createVNode(o,{title:"邮箱"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>e.unref(a).email=r),type:"text",placeholder:"邮箱",class:"base-input",name:"email"},null,512),[[e.vModelText,e.unref(a).email]]),t[4]||(t[4]=e.createElementVNode("span",{class:"input-info error"},"请输入邮箱",-1))]),_:1}),e.createVNode(o,{title:"密码"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>e.unref(a).password=r),type:"password",placeholder:"密码",class:"base-input",name:"password"},null,512),[[e.vModelText,e.unref(a).password]]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-info error"},"请输入密码",-1))]),_:1})])]),e.createElementVNode("div",h,[e.createElementVNode("a",{href:"javascript:;",class:"btn btn-yellow",onClick:b},"编辑用户"),e.createVNode(w,{to:"/backend/user/list",class:"btn btn-blue"},{default:e.withCtx(()=>t[6]||(t[6]=[e.createTextVNode("返回")])),_:1})])])}}});export{S as default};
