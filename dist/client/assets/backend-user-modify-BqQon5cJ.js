import{_ as b}from"./a-input.vue_vue_type_script_setup_true_lang-CJXytf3M.js";import{v as e,u as w,j as k,s as N,b as x,e as f,f as g}from"./main-vEEUWzS4.js";import{u as _}from"./use-backend-user-store-CS1x6hbk.js";import{u as y}from"./vue.f36acd1f-CR8QM_eY.js";const E={class:"settings-main card"},U={class:"settings-main-content"},M=e.createElementVNode("span",{class:"input-info error"},"请输入昵称",-1),C=e.createElementVNode("span",{class:"input-info error"},"请输入邮箱",-1),T=e.createElementVNode("span",{class:"input-info error"},"请输入密码",-1),B={class:"settings-footer"},I=e.defineComponent({name:"BackendUserModify",asyncData(u){const{store:d,route:i,api:l}=u;return _(d).getUserItem({id:i.params.id,path:i.fullPath,from:"backend"},l)},__name:"backend-user-modify",setup(u){const d=w(),i=k(),l=_(),c=N(l),n=e.toRef(c,"item"),[h,m]=x(!1),t=e.reactive({id:d.params.id,username:"",email:"",password:""});e.watch(n.value,s=>{s.data&&(t.username=s.data.username,t.email=s.data.email)}),e.onMounted(async()=>{n.value&&n.value.data&&(t.username=n.value.data.username,t.email=n.value.data.email)});async function v(){if(!t.username||!t.email){f("请将表单填写完整!");return}if(h.value)return;m(!0);const{code:s,data:a,message:o}=await g.post("backend/user/modify",t);m(!1),s===200&&(f({type:"success",content:o}),l.updateUserItem(a),i.push("/backend/user/list"))}const p=e.ref("用户编辑 - M.M.F 小屋");return y({title:p,meta:[{name:"description",content:p}]}),(s,a)=>{const o=b,V=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",E,[e.createElementVNode("div",U,[e.createElementVNode("form",null,[e.createVNode(o,{title:"昵称"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[0]||(a[0]=r=>e.unref(t).username=r),type:"text",placeholder:"昵称",class:"base-input",name:"username"},null,512),[[e.vModelText,e.unref(t).username]]),M]),_:1}),e.createVNode(o,{title:"邮箱"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[1]||(a[1]=r=>e.unref(t).email=r),type:"text",placeholder:"邮箱",class:"base-input",name:"email"},null,512),[[e.vModelText,e.unref(t).email]]),C]),_:1}),e.createVNode(o,{title:"密码"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[2]||(a[2]=r=>e.unref(t).password=r),type:"password",placeholder:"密码",class:"base-input",name:"password"},null,512),[[e.vModelText,e.unref(t).password]]),T]),_:1})])]),e.createElementVNode("div",B,[e.createElementVNode("a",{href:"javascript:;",class:"btn btn-yellow",onClick:v},"编辑用户"),e.createVNode(V,{to:"/backend/user/list",class:"btn btn-blue"},{default:e.withCtx(()=>[e.createTextVNode("返回")]),_:1})])])}}});export{I as default};
