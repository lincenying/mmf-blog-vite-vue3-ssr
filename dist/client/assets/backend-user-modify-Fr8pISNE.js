import{_ as M}from"./a-input.vue_vue_type_script_setup_true_lang-oFZQFnI9.js";import{d as V,u as C,N as T,s as h,t as B,l as N,A as R,U as S,I as D,r as I,h as H,o as P,c as $,b as t,e as d,w as m,G as c,p as n,H as f,i as j,C as v,D as A}from"./main-CTY4IKlK.js";import{u as w}from"./use-backend-user-store-BV1NK83z.js";import{u as E}from"./vue.8fc199ce-Bmv443Wm.js";const F={class:"settings-main card"},G={class:"settings-main-content"},L={class:"settings-footer"},O=V({name:"BackendUserModify",asyncData(b){const{store:p,route:l,api:u}=b;return w(p).getUserItem({id:l.params.id,path:l.fullPath,from:"backend"},u)},__name:"backend-user-modify",setup(b){const p=C(),l=T(),u=w(),_=h(u),o=B(_,"item"),[y,k]=N(!1),s=R({id:p.params.id,username:"",email:"",password:""});S(o.value,a=>{a.data&&(s.username=a.data.username,s.email=a.data.email)}),D(async()=>{o.value&&o.value.data&&(s.username=o.value.data.username,s.email=o.value.data.email)});async function U(){if(!s.username||!s.email){v("请将表单填写完整!");return}if(y.value)return;k(!0);const{code:a,data:e,message:r}=await A.post("backend/user/modify",s);k(!1),a===200&&(v({type:"success",content:r}),u.updateUserItem(e),l.push("/backend/user/list"))}const g=I("用户编辑 - M.M.F 小屋");return E({title:g,meta:[{name:"description",content:g}]}),(a,e)=>{const r=M,x=H("router-link");return P(),$("div",F,[t("div",G,[t("form",null,[d(r,{title:"昵称"},{default:m(()=>[c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>n(s).username=i),type:"text",placeholder:"昵称",class:"base-input",name:"username"},null,512),[[f,n(s).username]]),e[3]||(e[3]=t("span",{class:"input-info error"},"请输入昵称",-1))]),_:1}),d(r,{title:"邮箱"},{default:m(()=>[c(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>n(s).email=i),type:"text",placeholder:"邮箱",class:"base-input",name:"email"},null,512),[[f,n(s).email]]),e[4]||(e[4]=t("span",{class:"input-info error"},"请输入邮箱",-1))]),_:1}),d(r,{title:"密码"},{default:m(()=>[c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>n(s).password=i),type:"password",placeholder:"密码",class:"base-input",name:"password"},null,512),[[f,n(s).password]]),e[5]||(e[5]=t("span",{class:"input-info error"},"请输入密码",-1))]),_:1})])]),t("div",L,[t("a",{href:"javascript:;",class:"btn btn-yellow",onClick:U},"编辑用户"),d(x,{to:"/backend/user/list",class:"btn btn-blue"},{default:m(()=>e[6]||(e[6]=[j("返回")])),_:1})])])}}});export{O as default};
