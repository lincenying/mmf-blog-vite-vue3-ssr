import{v as t,h,f as l}from"./main-BBnOZaJ_.js";const f={class:"card card-trending"},k={class:"card-content"},v={class:"trending-rank-num"},N={class:"trending-meta"},E={class:"trending-meta-item"},V={class:"trending-meta-item"},y=t.defineComponent({name:"AsideTrending",__name:"aside-trending",props:{trending:{}},setup(n){const r=n,d=t.toRefs(r),c=t.toRef(d,"trending");return(m,e)=>{const s=t.resolveComponent("router-link");return t.openBlock(),t.createElementBlock("div",f,[e[2]||(e[2]=t.createElementVNode("h2",{class:"card-title"},"热门文章",-1)),t.createElementVNode("div",k,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.value,(a,i)=>(t.openBlock(),t.createElementBlock("div",{key:a._id,class:"trending-item"},[t.createElementVNode("span",v,t.toDisplayString(i+1),1),t.createVNode(s,{to:`/article/${a._id}`,class:"trending-title"},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(a.title),1)]),_:2},1032,["to"]),t.createElementVNode("div",N,[t.createElementVNode("div",E,[e[0]||(e[0]=t.createElementVNode("i",{class:"icon icon-action-voteup"},null,-1)),t.createTextVNode(t.toDisplayString(a.like),1)]),t.createElementVNode("div",V,[e[1]||(e[1]=t.createElementVNode("i",{class:"icon icon-action-comment"},null,-1)),t.createTextVNode(t.toDisplayString(a.comment_count),1)])])]))),128))])])}}}),S=h("frontendArticleStore",()=>{const n=t.reactive({lists:{data:[],path:"",hasNext:0,hasPrev:0,page:1},item:{data:null,path:""},trending:[]}),r=async(e,s=l)=>{if(n.lists.data.length>0&&e.path===n.lists.path&&e.page===1)return;const{code:a,data:i}=await s.get("frontend/article/list",{...e,path:void 0,cache:!0});if(a===200&&i){const{list:o=[],path:g,hasNext:u=0,hasPrev:_=0,page:p}={...i,path:e.path,page:e.page};n.lists={data:p===1?o:n.lists.data.concat(o),hasNext:u,hasPrev:_,page:(p||1)+1,path:g}}},d=async(e,s=l)=>{const{code:a,data:i}=await s.get("frontend/article/item",{...e,path:void 0,markdown:1,cache:!0});a===200&&i&&(n.item={data:i,...e,isLoad:!0})},c=async(e={},s=l)=>{if(n.trending.length)return;const{code:a,data:i}=await s.get("frontend/trending",{...e,cache:!0});a===200&&i&&(n.trending=i.list)},m=e=>{const{id:s,status:a}=e;n.item.data&&n.item.data._id===s&&(a?n.item.data.like++:n.item.data.like--,n.item.data.like_status=a);const i=n.lists.data.findIndex(o=>o._id===s);if(i>-1){const o=Object.assign({},n.lists.data[i]);a?o.like++:o.like--,o.like_status=a,n.lists.data.splice(i,1,o)}};return{...t.toRefs(n),getArticleList:r,getArticleItem:d,getTrending:c,modifyLikeStatus:m}});export{y as _,S as u};
