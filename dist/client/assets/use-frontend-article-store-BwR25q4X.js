import{d as y,t as f,B as w,c as l,g as o,a7 as L,a8 as N,f as p,K as S,a6 as d,L as A,a5 as m,J as B,m as C,h as P}from"./vendor-C8cObGch.js";import{c as g}from"./main-Bpljy6lB.js";const T={class:"card card-trending"},V={class:"card-content"},b={class:"trending-rank-num"},j={class:"trending-meta"},I={class:"trending-meta-item"},R={class:"trending-meta-item"},E=y({name:"AsideTrending",__name:"aside-trending",props:{trending:{}},setup(e){const r=f(e),c=w(r,"trending");return(_,t)=>{const n=B("router-link");return p(),l("div",T,[t[2]||(t[2]=o("h2",{class:"card-title"},"热门文章",-1)),o("div",V,[(p(!0),l(L,null,N(c.value,(a,s)=>(p(),l("div",{key:a._id,class:"trending-item"},[o("span",b,d(s+1),1),S(n,{to:`/article/${a._id}`,class:"trending-title"},{default:A(()=>[m(d(a.title),1)]),_:2},1032,["to"]),o("div",j,[o("div",I,[t[0]||(t[0]=o("i",{class:"icon icon-action-voteup"},null,-1)),m(d(a.like),1)]),o("div",R,[t[1]||(t[1]=o("i",{class:"icon icon-action-comment"},null,-1)),m(d(a.comment_count),1)])])]))),128))])])}}}),F=C("frontendArticleStore",()=>{const e=P({lists:{data:[],path:"",hasNext:0,hasPrev:0,page:1},item:{data:null,path:""},trending:[]}),u=async(t,n=g)=>{if(e.lists.data.length>0&&t.path===e.lists.path&&t.page===1)return;const{code:a,data:s}=await n.get("frontend/article/list",{...t,path:void 0,cache:!0});if(a===200&&s){const{list:i=[],path:k,hasNext:v=0,hasPrev:x=0,page:h}={...s,path:t.path,page:t.page};e.lists={data:h===1?i:e.lists.data.concat(i),hasNext:v,hasPrev:x,page:(h||1)+1,path:k}}},r=async(t,n=g)=>{const{code:a,data:s}=await n.get("frontend/article/item",{...t,path:void 0,markdown:1,cache:!0});a===200&&s&&(e.item={data:s,...t,isLoad:!0})},c=async(t={},n=g)=>{if(e.trending.length)return;const{code:a,data:s}=await n.get("frontend/trending",{...t,cache:!0});a===200&&s&&(e.trending=s.list)},_=t=>{const{id:n,status:a}=t;e.item.data&&e.item.data._id===n&&(a?e.item.data.like++:e.item.data.like--,e.item.data.like_status=a);const s=e.lists.data.findIndex(i=>i._id===n);if(s>-1){const i=Object.assign({},e.lists.data[s]);a?i.like++:i.like--,i.like_status=a,e.lists.data.splice(s,1,i)}};return{...f(e),getArticleList:u,getArticleItem:r,getTrending:c,modifyLikeStatus:_}});export{E as _,F as u};
