import{v as t,h as p,i as f,f as _}from"./main-sEuxawHt.js";const k={class:"card card-trending"},v=t.createElementVNode("h2",{class:"card-title"},"热门文章",-1),E={class:"card-content"},N={class:"trending-rank-num"},V=["to","onClick"],x={class:"trending-meta"},y={class:"trending-meta-item"},S=t.createElementVNode("i",{class:"icon icon-action-voteup"},null,-1),B={class:"trending-meta-item"},A=t.createElementVNode("i",{class:"icon icon-action-comment"},null,-1),D=t.defineComponent({name:"AsideTrending",__name:"aside-trending",props:{trending:null},setup(n){const c=n,r=t.toRefs(c),d=t.toRef(r,"trending"),l=p();function s(a){console.log(a),l.push(`/article/${a}`)}return(a,i)=>(t.openBlock(),t.createElementBlock("div",k,[v,t.createElementVNode("div",E,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(d.value,(e,o)=>(t.openBlock(),t.createElementBlock("div",{key:e._id,class:"trending-item"},[t.createElementVNode("span",N,t.toDisplayString(o+1),1),t.createElementVNode("a",{href:"javascript:;",to:`/article/${e._id}`,class:"trending-title",onClick:m=>s(e._id)},t.toDisplayString(e.title),9,V),t.createElementVNode("div",x,[t.createElementVNode("div",y,[S,t.createTextVNode(t.toDisplayString(e.like),1)]),t.createElementVNode("div",B,[A,t.createTextVNode(t.toDisplayString(e.comment_count),1)])])]))),128))])]))}}),T=f("frontendArticleStore",()=>{const n=t.reactive({lists:{data:[],path:"",hasNext:0,hasPrev:0,page:1},item:{data:null,path:""},trending:[]}),c=async(s,a)=>{if(a||(a=_),n.lists.data.length>0&&s.path===n.lists.path&&s.page===1)return;const{code:i,data:e}=await a.get("frontend/article/list",{...s,path:void 0,cache:!0});if(i===200&&e){const{list:o=[],path:m,hasNext:u=0,hasPrev:h=0,page:g}={...e,path:s.path,page:s.page};n.lists={data:g===1?o:n.lists.data.concat(o),hasNext:u,hasPrev:h,page:(g||1)+1,path:m}}},r=async(s,a)=>{a||(a=_);const{code:i,data:e}=await a.get("frontend/article/item",{...s,path:void 0,markdown:1,cache:!0});i===200&&e&&(n.item={data:e,...s,isLoad:!0})},d=async(s,a)=>{if(a||(a=_),n.trending.length)return;const{code:i,data:e}=await a.get("frontend/trending",{cache:!0});i===200&&e&&(n.trending=e.list)},l=s=>{const{id:a,status:i}=s;n.item.data&&n.item.data._id===a&&(i?n.item.data.like++:n.item.data.like--,n.item.data.like_status=i);const e=n.lists.data.findIndex(o=>o._id===a);if(e>-1){const o=Object.assign({},n.lists.data[e]);i?o.like++:o.like--,o.like_status=i,n.lists.data.splice(e,1,o)}};return{...t.toRefs(n),getArticleList:c,getArticleItem:r,getTrending:d,modifyLikeStatus:l}}),L=T;export{D as _,L as u};
