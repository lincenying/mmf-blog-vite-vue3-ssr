import{d as w,g as f,t as y,h as A,o as l,c as p,b as d,F as N,q as S,j as o,e as L,w as b,i as g,J as j,A as B,D as m}from"./main-CTY4IKlK.js";const C={class:"card card-trending"},P={class:"card-content"},T={class:"trending-rank-num"},V={class:"trending-meta"},D={class:"trending-meta-item"},F={class:"trending-meta-item"},R=w({name:"AsideTrending",__name:"aside-trending",props:{trending:{}},setup(e){const r=f(e),c=y(r,"trending");return(_,t)=>{const n=A("router-link");return l(),p("div",C,[t[2]||(t[2]=d("h2",{class:"card-title"},"热门文章",-1)),d("div",P,[(l(!0),p(N,null,S(c.value,(a,s)=>(l(),p("div",{key:a._id,class:"trending-item"},[d("span",T,o(s+1),1),L(n,{to:`/article/${a._id}`,class:"trending-title"},{default:b(()=>[g(o(a.title),1)]),_:2},1032,["to"]),d("div",V,[d("div",D,[t[0]||(t[0]=d("i",{class:"icon icon-action-voteup"},null,-1)),g(o(a.like),1)]),d("div",F,[t[1]||(t[1]=d("i",{class:"icon icon-action-comment"},null,-1)),g(o(a.comment_count),1)])])]))),128))])])}}}),$=j("frontendArticleStore",()=>{const e=B({lists:{data:[],path:"",hasNext:0,hasPrev:0,page:1},item:{data:null,path:""},trending:[]}),u=async(t,n=m)=>{if(e.lists.data.length>0&&t.path===e.lists.path&&t.page===1)return;const{code:a,data:s}=await n.get("frontend/article/list",{...t,path:void 0,cache:!0});if(a===200&&s){const{list:i=[],path:k,hasNext:v=0,hasPrev:x=0,page:h}={...s,path:t.path,page:t.page};e.lists={data:h===1?i:e.lists.data.concat(i),hasNext:v,hasPrev:x,page:(h||1)+1,path:k}}},r=async(t,n=m)=>{const{code:a,data:s}=await n.get("frontend/article/item",{...t,path:void 0,markdown:1,cache:!0});a===200&&s&&(e.item={data:s,...t,isLoad:!0})},c=async(t={},n=m)=>{if(e.trending.length)return;const{code:a,data:s}=await n.get("frontend/trending",{...t,cache:!0});a===200&&s&&(e.trending=s.list)},_=t=>{const{id:n,status:a}=t;e.item.data&&e.item.data._id===n&&(a?e.item.data.like++:e.item.data.like--,e.item.data.like_status=a);const s=e.lists.data.findIndex(i=>i._id===n);if(s>-1){const i=Object.assign({},e.lists.data[s]);a?i.like++:i.like--,i.like_status=a,e.lists.data.splice(s,1,i)}};return{...f(e),getArticleList:u,getArticleItem:r,getTrending:c,modifyLikeStatus:_}});export{R as _,$ as u};
