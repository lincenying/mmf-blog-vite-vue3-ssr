import{v as t,h,f as l}from"./main-BCpYjCEU.js";const f={class:"card card-trending"},k=t.createElementVNode("h2",{class:"card-title"},"热门文章",-1),v={class:"card-content"},N={class:"trending-rank-num"},E={class:"trending-meta"},V={class:"trending-meta-item"},x=t.createElementVNode("i",{class:"icon icon-action-voteup"},null,-1),y={class:"trending-meta-item"},S=t.createElementVNode("i",{class:"icon icon-action-comment"},null,-1),A=t.defineComponent({name:"AsideTrending",__name:"aside-trending",props:{trending:null},setup(e){const c=e,r=t.toRefs(c),d=t.toRef(r,"trending");return(m,s)=>{const i=t.resolveComponent("router-link");return t.openBlock(),t.createElementBlock("div",f,[k,t.createElementVNode("div",v,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(d.value,(n,a)=>(t.openBlock(),t.createElementBlock("div",{key:n._id,class:"trending-item"},[t.createElementVNode("span",N,t.toDisplayString(a+1),1),t.createVNode(i,{to:`/article/${n._id}`,class:"trending-title"},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(n.title),1)]),_:2},1032,["to"]),t.createElementVNode("div",E,[t.createElementVNode("div",V,[x,t.createTextVNode(t.toDisplayString(n.like),1)]),t.createElementVNode("div",y,[S,t.createTextVNode(t.toDisplayString(n.comment_count),1)])])]))),128))])])}}}),B=h("frontendArticleStore",()=>{const e=t.reactive({lists:{data:[],path:"",hasNext:0,hasPrev:0,page:1},item:{data:null,path:""},trending:[]}),c=async(s,i=l)=>{if(e.lists.data.length>0&&s.path===e.lists.path&&s.page===1)return;const{code:n,data:a}=await i.get("frontend/article/list",{...s,path:void 0,cache:!0});if(n===200&&a){const{list:o=[],path:p,hasNext:g=0,hasPrev:u=0,page:_}={...a,path:s.path,page:s.page};e.lists={data:_===1?o:e.lists.data.concat(o),hasNext:g,hasPrev:u,page:(_||1)+1,path:p}}},r=async(s,i=l)=>{const{code:n,data:a}=await i.get("frontend/article/item",{...s,path:void 0,markdown:1,cache:!0});n===200&&a&&(e.item={data:a,...s,isLoad:!0})},d=async(s={},i=l)=>{if(e.trending.length)return;const{code:n,data:a}=await i.get("frontend/trending",{...s,cache:!0});n===200&&a&&(e.trending=a.list)},m=s=>{const{id:i,status:n}=s;e.item.data&&e.item.data._id===i&&(n?e.item.data.like++:e.item.data.like--,e.item.data.like_status=n);const a=e.lists.data.findIndex(o=>o._id===i);if(a>-1){const o=Object.assign({},e.lists.data[a]);n?o.like++:o.like--,o.like_status=n,e.lists.data.splice(a,1,o)}};return{...t.toRefs(e),getArticleList:c,getArticleItem:r,getTrending:d,modifyLikeStatus:m}}),T=B;export{A as _,T as u};
