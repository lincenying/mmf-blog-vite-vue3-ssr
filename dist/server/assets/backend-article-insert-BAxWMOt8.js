import{e as F,_ as H,c as I}from"../entry-server.js";import{_ as N}from"./a-input-BeZLXpwF.js";import{defineComponent as j,toRef as E,ref as b,reactive as G,onMounted as z,resolveComponent as J,mergeProps as K,withCtx as h,unref as t,withDirectives as R,createVNode as s,vModelText as O,createBlock as x,openBlock as k,Fragment as Q,renderList as W,toDisplayString as X,vModelSelect as Y,createCommentVNode as Z,useSSRContext as ee}from"vue";import{ssrRenderAttrs as te,ssrRenderComponent as u,ssrRenderAttr as L,ssrIncludeBooleanAttr as C,ssrLooseContain as w,ssrLooseEqual as D,ssrRenderList as oe,ssrInterpolate as re}from"vue/server-renderer";import{u as M}from"./upload-api-D6N3NHls.js";import{u as B}from"./use-global-category-store-BpFdaCEC.js";import{useRouter as ae}from"vue-router";import{storeToRefs as ie}from"pinia";import{u as ne}from"./use-backend-article-store-D5khvARS.js";import{useToggle as le}from"@vueuse/core";import{useHead as se}from"@unhead/vue";import"node:path";import"@unhead/vue/server";import"@vue/server-renderer";import"./vendor-Dh2hNSeG.js";import"@vue/shared";import"@popperjs/core";import"lodash-unified";import"dayjs";import"dayjs/plugin/localeData.js";import"dayjs/plugin/customParseFormat.js";import"dayjs/plugin/advancedFormat.js";import"dayjs/plugin/weekOfYear.js";import"dayjs/plugin/weekYear.js";import"dayjs/plugin/dayOfYear.js";import"dayjs/plugin/isSameOrAfter.js";import"dayjs/plugin/isSameOrBefore.js";import"normalize-wheel-es";import"@element-plus/icons-vue";import"@ctrl/tinycolor";import"@lincy/utils";import"md5";import"axios";import"qs";import"js-cookie";import"lru-cache";import"node:process";import"@kangc/v-md-editor";import"@kangc/v-md-editor/lib/plugins/line-number/index.js";import"@kangc/v-md-editor/lib/theme/vuepress.js";import"prismjs";import"prismjs/components/prism-json.js";import"prismjs/components/prism-javascript.js";import"prismjs/components/prism-typescript.js";import"prismjs/components/prism-markup-templating.js";import"prismjs/components/prism-php.js";import"prismjs/components/prism-twig.js";import"prismjs/components/prism-css.js";import"prismjs/components/prism-sass.js";import"prismjs/components/prism-less.js";import"prismjs/components/prism-bash.js";const T=j({name:"BackendArticleInsert",asyncData(d){const{store:c,route:l,api:f}=d;return B(c).getCategoryList({limit:99,path:l.fullPath},f)},__name:"backend-article-insert",__ssrInlineRender:!0,setup(d){const{ctx:c}=F();ae();const l=B(),f=ie(l),g=E(f,"lists");ne();let v=b(!1);const y=b(!0),[ce,me]=le(!1),o=G({title:"",category:"",content:"",html:""});z(async()=>{v.value=!0});async function V(q,i,m){const _=c.$loading.show(),p=new FormData;p.append("file",m[0]);try{const{data:n}=await I.file(`${M}/api/fetch/upload`,p);n&&n.filepath&&i({url:`${M}/${n.filepath}`,desc:""})}catch(n){console.log(n)}_.hide()}const A=b("发布文章 - M.M.F 小屋");return se({title:A,meta:[{name:"description",content:A}]}),(q,i,m,_)=>{const p=N,n=H,S=J("v-md-editor");i(`<div${te(K({class:"settings-main card"},_))}><div class="settings-main-content">`),i(u(p,{title:"标题"},{default:h((U,r,$,a)=>{if(r)r(`<input${L("value",t(o).title)} type="text" placeholder="标题" class="base-input" name="title"${a}><span class="input-info error"${a}>请输入标题</span>`);else return[R(s("input",{"onUpdate:modelValue":e=>t(o).title=e,type:"text",placeholder:"标题",class:"base-input",name:"title"},null,8,["onUpdate:modelValue"]),[[O,t(o).title]]),s("span",{class:"input-info error"},"请输入标题")]}),_:1},m)),i(u(p,{title:"分类",classes:"select-item-wrap"},{default:h((U,r,$,a)=>{if(r)r(`<i class="icon icon-arrow-down"${a}></i><select class="select-item" name="category"${a}><option value=""${C(Array.isArray(t(o).category)?w(t(o).category,""):D(t(o).category,""))?" selected":""}${a}>请选择分类</option><!--[-->`),oe(g.value,e=>{r(`<option${L("value",`${e._id}|${e.cate_name}`)}${C(Array.isArray(t(o).category)?w(t(o).category,`${e._id}|${e.cate_name}`):D(t(o).category,`${e._id}|${e.cate_name}`))?" selected":""}${a}>${re(e.cate_name)}</option>`)}),r(`<!--]--></select><span class="input-info error"${a}>请输入分类</span>`);else return[s("i",{class:"icon icon-arrow-down"}),R(s("select",{"onUpdate:modelValue":e=>t(o).category=e,class:"select-item",name:"category"},[s("option",{value:""},"请选择分类"),(k(!0),x(Q,null,W(g.value,e=>(k(),x("option",{key:e._id,value:`${e._id}|${e.cate_name}`},X(e.cate_name),9,["value"]))),128))],8,["onUpdate:modelValue"]),[[Y,t(o).category]]),s("span",{class:"input-info error"},"请输入分类")]}),_:1},m)),i('<div class="settings-section"><div id="post-content" class="settings-item-content">'),i(u(n,null,{default:h((U,r,$,a)=>{if(r)t(v)?r(u(S,{modelValue:t(o).content,"onUpdate:modelValue":e=>t(o).content=e,"disabled-menus":[],mode:"edit",height:"500px","left-toolbar":"undo redo clear | h bold italic strikethrough link | ul ol table hr | image quote code tip | save",onUploadImage:V},null,$,a)):r("<!---->");else return[t(v)?(k(),x(S,{key:0,modelValue:t(o).content,"onUpdate:modelValue":e=>t(o).content=e,"disabled-menus":[],mode:"edit",height:"500px","left-toolbar":"undo redo clear | h bold italic strikethrough link | ul ol table hr | image quote code tip | save",onUploadImage:V},null,8,["modelValue","onUpdate:modelValue"])):Z("",!0)]}),_:1},m)),i(`</div></div></div><div class="settings-footer"><label mr-10px inline-flex items-center><input${C(Array.isArray(t(y))?w(t(y),"1"):t(y))?" checked":""} type="checkbox" value="1"><span ml-5px>使用前端生成Html?</span></label><a href="javascript:;" class="btn btn-yellow">添加文章</a></div></div>`)}}}),P=T.setup;T.setup=(d,c)=>{const l=ee();return(l.modules||(l.modules=new Set)).add("src/pages/backend-article-insert.vue"),P?P(d,c):void 0};export{T as default};
