import{e as T,c as F,_ as L}from"../entry-server.js";import{_ as j}from"./a-input-a46fa5e4.js";import{defineComponent as G,toRef as N,ref as U,reactive as P,onMounted as H,resolveComponent as I,mergeProps as q,withCtx as y,unref as o,withDirectives as h,createVNode as i,vModelText as z,openBlock as b,createBlock as C,Fragment as E,renderList as J,toDisplayString as K,vModelSelect as O,createCommentVNode as Q,useSSRContext as W}from"vue";import{ssrRenderAttrs as X,ssrRenderComponent as u,ssrRenderAttr as R,ssrRenderList as Y,ssrInterpolate as Z}from"vue/server-renderer";import{u as k}from"./upload-api-acac9f68.js";import{u as A}from"./use-global-category-store-9a41de21.js";import{useRouter as ee}from"vue-router";import{storeToRefs as te}from"pinia";import{u as oe}from"./use-backend-article-store-0d766600.js";import{useToggle as ae}from"@vueuse/core";import{useHead as ne}from"@vueuse/head";import"node:path";import"@vue/server-renderer";import"js-cookie";import"@lincy/utils";import"axios";import"qs";import"element-plus";import"md5";import"lru-cache";const M=G({name:"BackendArticleInsert",asyncData(p){const{store:c,route:s,api:f}=p;return A(c).getCategoryList({limit:99,path:s.fullPath},f)},__name:"backend-article-insert",__ssrInlineRender:!0,setup(p){const{ctx:c}=T();ee();const s=A(),f=te(s),g=N(f,"lists");oe();let v=U(!1);ae(!1);const n=P({title:"",category:"",content:"",html:""});H(async()=>{v.value=!0});async function w(B,r,m){const _=c.$loading.show(),d=new FormData;d.append("file",m[0]);try{const{data:l}=await F.file(`${k}/ajax.php?action=upload`,d);l&&l.filepath&&r({url:`${k}/${l.filepath}`,desc:""})}catch(l){console.log(l)}_.hide()}const x=U("发布文章 - M.M.F 小屋");return ne({title:x,meta:[{name:"description",content:x}]}),(B,r,m,_)=>{const d=j,l=L,V=I("v-md-editor");r(`<div${X(q({class:"settings-main card"},_))}><div class="settings-main-content">`),r(u(d,{title:"标题"},{default:y((S,t,$,a)=>{if(t)t(`<input${R("value",o(n).title)} type="text" placeholder="标题" class="base-input" name="title"${a}><span class="input-info error"${a}>请输入标题</span>`);else return[h(i("input",{"onUpdate:modelValue":e=>o(n).title=e,type:"text",placeholder:"标题",class:"base-input",name:"title"},null,8,["onUpdate:modelValue"]),[[z,o(n).title]]),i("span",{class:"input-info error"},"请输入标题")]}),_:1},m)),r(u(d,{title:"分类",classes:"select-item-wrap"},{default:y((S,t,$,a)=>{if(t)t(`<i class="icon icon-arrow-down"${a}></i><select class="select-item" name="category"${a}><option value=""${a}>请选择分类</option><!--[-->`),Y(g.value,e=>{t(`<option${R("value",`${e._id}|${e.cate_name}`)}${a}>${Z(e.cate_name)}</option>`)}),t(`<!--]--></select><span class="input-info error"${a}>请输入分类</span>`);else return[i("i",{class:"icon icon-arrow-down"}),h(i("select",{"onUpdate:modelValue":e=>o(n).category=e,class:"select-item",name:"category"},[i("option",{value:""},"请选择分类"),(b(!0),C(E,null,J(g.value,e=>(b(),C("option",{key:e._id,value:`${e._id}|${e.cate_name}`},K(e.cate_name),9,["value"]))),128))],8,["onUpdate:modelValue"]),[[O,o(n).category]]),i("span",{class:"input-info error"},"请输入分类")]}),_:1},m)),r('<div class="settings-section"><div id="post-content" class="settings-item-content">'),r(u(l,null,{default:y((S,t,$,a)=>{if(t)o(v)?t(u(V,{modelValue:o(n).content,"onUpdate:modelValue":e=>o(n).content=e,"disabled-menus":[],mode:"edit",height:"500px",onUploadImage:w},null,$,a)):t("<!---->");else return[o(v)?(b(),C(V,{key:0,modelValue:o(n).content,"onUpdate:modelValue":e=>o(n).content=e,"disabled-menus":[],mode:"edit",height:"500px",onUploadImage:w},null,8,["modelValue","onUpdate:modelValue"])):Q("",!0)]}),_:1},m)),r('</div></div></div><div class="settings-footer"><a href="javascript:;" class="btn btn-yellow">添加文章</a></div></div>')}}}),D=M.setup;M.setup=(p,c)=>{const s=W();return(s.modules||(s.modules=new Set)).add("src/pages/backend-article-insert.vue"),D?D(p,c):void 0};export{M as default};
