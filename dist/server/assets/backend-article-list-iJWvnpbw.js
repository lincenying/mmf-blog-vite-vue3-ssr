import{defineComponent as I,toRef as g,onMounted as M,ref as h,resolveComponent as D,mergeProps as N,unref as _,withCtx as S,createTextVNode as b,useSSRContext as B}from"vue";import{ssrRenderAttrs as F,ssrRenderList as H,ssrRenderClass as V,ssrInterpolate as c,ssrRenderComponent as k}from"vue/server-renderer";import{getDateDiff as q}from"@lincy/utils";import{u as $}from"./use-backend-article-store-BMOF_Kc5.js";import{useRoute as z}from"vue-router";import{f as E,u as G}from"../entry-server.js";import{storeToRefs as R}from"pinia";import{useToggle as J}from"@vueuse/core";import{useHead as K}from"@unhead/vue";import"node:path";import"@unhead/vue/server";import"@vue/server-renderer";import"element-plus";import"md5";import"axios";import"qs";import"js-cookie";import"lru-cache";import"node:process";const y=I({name:"BackendArticleList",asyncData(o){const{store:s,route:a,api:r}=o;return $(s).getArticleList({page:1,path:a.fullPath},r)},__name:"backend-article-list",__ssrInlineRender:!0,setup(o){const s=z(),a=E(),r=$(),d=R(r),l=g(d,"lists"),T=R(a),A=g(T,"historyPageScrollTop");G();const[m,f]=J(!1);async function C(n=l.value.page){m.value||(f(!0),await r.getArticleList({page:n,path:s.fullPath}),f(!1))}M(()=>{if(l.value.path==="")C(1);else{const n=A.value[s.path]||0;window.scrollTo(0,n)}});const p=h("文章列表 - M.M.F 小屋");return K({title:p,meta:[{name:"description",content:p}]}),(n,e,v,P)=>{const u=D("router-link");e(`<div${F(N({class:"settings-main card"},P))}><div class="settings-main-content"><div class="list-section list-header"><div class="list-title">标题</div><div class="list-category">分类</div><div class="list-date">最后更新</div><div class="list-action">操作</div></div><!--[-->`),H(l.value.data,t=>{e(`<div class="list-section"><div class="${V([t.is_delete?"text-red-500 line-through":"","list-title"])}">${c(t.title)}</div><div class="list-category">${c(t.category_name)}</div><div class="list-date">${c(_(q)(t.update_date))}</div><div class="list-action">`),e(k(u,{to:`/backend/article/modify/${t._id}`,class:"badge badge-success"},{default:S((w,i,L,j)=>{if(i)i("编辑");else return[b("编辑")]}),_:2},v)),t.is_delete?e('<a href="javascript:;">恢复</a>'):e('<a href="javascript:;">删除</a>'),t.comment_count>0?e(k(u,{to:`/backend/article/comment/${t._id}`,class:"badge badge-success"},{default:S((w,i,L,j)=>{if(i)i(" 评论 ");else return[b(" 评论 ")]}),_:2},v)):e("<!---->"),e("</div></div>")}),e("<!--]--></div>"),l.value.hasNext?(e('<div class="settings-footer">'),_(m)?e('<a class="admin-load-more" href="javascript:;">加载中...</a>'):e('<a class="admin-load-more" href="javascript:;">加载更多</a>'),e("</div>")):e("<!---->"),e("</div>")}}}),x=y.setup;y.setup=(o,s)=>{const a=B();return(a.modules||(a.modules=new Set)).add("src/pages/backend-article-list.vue"),x?x(o,s):void 0};export{y as default};
