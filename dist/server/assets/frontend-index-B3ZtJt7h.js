import{_ as X,a as Y,b as Z}from"./item-actions-DtYvRu23.js";import{u as V,_ as ee}from"./use-frontend-article-store-C57bp_9v.js";import{defineComponent as L,mergeProps as I,useSSRContext as P,toRefs as te,toRef as S,resolveComponent as re,withCtx as C,createTextVNode as _,toDisplayString as H,onActivated as oe,computed as ie,unref as A,createVNode as u}from"vue";import{ssrRenderAttrs as N,ssrRenderSlot as ne,ssrRenderComponent as d,ssrInterpolate as $,ssrRenderList as se,ssrRenderClass as ae}from"vue/server-renderer";import{ContentLoader as ce}from"vue-content-loader";import{u as q}from"./use-global-category-store-BpFdaCEC.js";import{useRoute as de}from"vue-router";import{storeToRefs as z}from"pinia";import{u as le}from"../entry-server.js";import{useToggle as me}from"@vueuse/core";import{useHead as fe}from"@unhead/vue";import"node:path";import"@unhead/vue/server";import"@vue/server-renderer";import"element-plus";import"@lincy/utils";import"md5";import"axios";import"qs";import"js-cookie";import"lru-cache";import"node:process";const M=L({name:"TopicsItemNone",__name:"topics-item-none",__ssrInlineRender:!0,setup(n){return(o,t,r,f)=>{t(`<div${N(I({class:"card feed"},f))}><div class="feed-content"><div class="feed-desc-wrap"><div class="feed-article-content markdown-body">`),ne(o.$slots,"default",{},null,t,r),t("</div></div></div></div>")}}}),B=M.setup;M.setup=(n,o)=>{const t=P();return(t.modules||(t.modules=new Set)).add("src/components/topics-item-none.vue"),B?B(n,o):void 0};const j=L({name:"TopicsItem",__name:"topics-item",__ssrInlineRender:!0,props:{item:{}},setup(n){const t=te(n),r=S(t,"item");return(f,i,l,s)=>{const v=re("router-link"),y=X;i(`<div${N(I({class:"card feed"},s))}><div class="feed-content"><div class="feed-source-time"><span class="feed-source">来自分类 `),i(d(v,{to:`/category/${r.value.category}`,class:"feed-minor-link"},{default:C((R,p,b,g)=>{if(p)p(`${$(r.value.category_name)}`);else return[_(H(r.value.category_name),1)]}),_:1},l)),i(`</span><span class="feed-time">${$(r.value.update_date)}</span></div><div class="feed-main-link-wrap">`),i(d(v,{to:`/article/${r.value._id}`,class:"feed-main-link"},{default:C((R,p,b,g)=>{if(p)p(`${$(r.value.title)}`);else return[_(H(r.value.title),1)]}),_:1},l)),i(`</div><div class="feed-desc-wrap"><div class="feed-article-content markdown-body">${$(r.value.content)}</div></div></div>`),i(d(y,{item:r.value},null,l)),i("</div>")}}}),E=j.setup;j.setup=(n,o)=>{const t=P();return(t.modules||(t.modules=new Set)).add("src/components/topics-item.vue"),E?E(n,o):void 0};const J=L({name:"FrontendIndex",asyncData(n){const{store:o,route:t,api:r}=n,{params:{id:f,key:i,by:l},fullPath:s}=t,v=q(o),y=V(o);return Promise.all([v.getCategoryList({},r),y.getTrending(void 0,r),y.getArticleList({page:1,limit:10,id:f,path:s,key:i,by:l},r)])},__name:"frontend-index",__ssrInlineRender:!0,setup(n){const o=de(),t=q(),r=z(t),f=S(r,"lists"),i=V(),l=z(i),s=S(l,"lists"),v=S(l,"trending");le();const{params:{id:y,key:R,by:p},path:b}=o,[g,D]=me(!1);async function K(a=s.value.page){g.value||(D(!0),await i.getArticleList({page:a,limit:10,id:y,path:b,key:R,by:p}),D(!1))}oe(()=>{console.log(`frontend-index onActivated:${o.path}`),s.value.path!==o.path&&K(1)});const F=ie(()=>{let a="M.M.F 小屋";const{id:e,key:c,by:k}=o.params;if(e){const h=f.value.find(T=>T._id===e);h&&(a=`${h.cate_name} - ${a}`)}else c?a=`搜索: ${c} - ${a}`:k&&(a=`热门 - ${a}`);return a});return fe({title:F,meta:[{name:"description",content:F}]}),(a,e,c,k)=>{const h=j,T=M,O=Y,Q=ee,U=Z;e(`<div${N(I({class:"main wrap"},k))}><div class="main-left"><div class="cards-wrap home-feeds">`),s.value.path?s.value.data.length>0?(e("<!--[--><!--[-->"),se(s.value.data,w=>{e(d(h,{key:w._id,item:w},null,c))}),e('<!--]--><div class="load-more-wrap">'),s.value.hasNext?e(`<a href="javascript:;" class="${ae([A(g)?"loading":"","load-more"])}">${$(A(g)?"加载中":"更多")} <i class="icon icon-circle-loading"></i></a>`):e("<!---->"),e("</div><!--]-->")):e(d(T,null,{default:C((w,x,W,m)=>{if(x)x("当前分类还没有文章...");else return[_("当前分类还没有文章...")]}),_:1},c)):(e('<div class="card card-content-loader">'),e(d(A(ce),{height:160,width:660,speed:2,"primary-color":"#f3f3f3","secondary-color":"#ecebeb"},{default:C((w,x,W,m)=>{if(x)x(`<rect x="70" y="15" rx="4" ry="4" width="117" height="6.4"${m}></rect> <rect x="70" y="35" rx="3" ry="3" width="85" height="6.4"${m}></rect><rect x="0" y="80" rx="3" ry="3" width="550" height="6.4"${m}></rect> <rect x="0" y="100" rx="3" ry="3" width="620" height="6.4"${m}></rect><rect x="0" y="120" rx="3" ry="3" width="401" height="6.4"${m}></rect> <rect x="0" y="140" rx="3" ry="3" width="501" height="6.4"${m}></rect><circle cx="30" cy="30" r="30"${m}></circle>`);else return[u("rect",{x:"70",y:"15",rx:"4",ry:"4",width:"117",height:"6.4"}),_(),u("rect",{x:"70",y:"35",rx:"3",ry:"3",width:"85",height:"6.4"}),u("rect",{x:"0",y:"80",rx:"3",ry:"3",width:"550",height:"6.4"}),_(),u("rect",{x:"0",y:"100",rx:"3",ry:"3",width:"620",height:"6.4"}),u("rect",{x:"0",y:"120",rx:"3",ry:"3",width:"401",height:"6.4"}),_(),u("rect",{x:"0",y:"140",rx:"3",ry:"3",width:"501",height:"6.4"}),u("circle",{cx:"30",cy:"30",r:"30"})]}),_:1},c)),e("</div>")),e('</div></div><div class="main-right">'),e(d(O,{category:f.value},null,c)),e(d(Q,{trending:v.value},null,c)),e(d(U,null,null,c)),e("</div></div>")}}}),G=J.setup;J.setup=(n,o)=>{const t=P();return(t.modules||(t.modules=new Set)).add("src/pages/frontend-index.vue"),G?G(n,o):void 0};export{J as default};
